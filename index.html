<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onbora - Help New Hires Belong from Day One</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; }
        .animate-fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .hidden { display: none; }
        .chat-message { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body>
    <div id="app">
        <!-- Landing Page -->
        <div id="landing" class="min-h-screen bg-white">
            <nav class="flex justify-between items-center px-8 py-6 border-b border-gray-100">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-black rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-sm">O</span>
                    </div>
                    <span class="text-xl font-bold">Onbora</span>
                </div>
                <div class="flex items-center space-x-8">
                    <button class="text-gray-600 hover:text-black transition">Features</button>
                    <button class="text-gray-600 hover:text-black transition">How it Works</button>
                    <button class="text-gray-600 hover:text-black transition">Pricing</button>
                    <button 
                        onclick="showView('setup')"
                        class="bg-black text-white px-6 py-2.5 rounded-full hover:bg-gray-800 transition"
                    >
                        Get Started
                    </button>
                </div>
            </nav>

            <section class="max-w-6xl mx-auto px-8 py-20 text-center">
                <div class="animate-fade-in">
                    <h1 class="text-7xl font-bold leading-tight mb-6">
                        Help New Hires<br />
                        Belong from Day One
                    </h1>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-8">
                        Create personalized onboarding experiences that make every new employee 
                        feel welcomed, informed, and ready to contribute‚Äîwithout endless prep work for you.
                    </p>
                    <div class="flex justify-center space-x-4">
                        <button 
                            onclick="showView('setup')"
                            class="bg-black text-white px-8 py-4 rounded-full text-lg hover:bg-gray-800 transition"
                        >
                            Start Free Trial
                        </button>
                        <button 
                            onclick="showView('employee')"
                            class="border-2 border-black text-black px-8 py-4 rounded-full text-lg hover:bg-gray-50 transition"
                        >
                            See Demo
                        </button>
                    </div>
                </div>
            </section>

            <!-- How it Works Section -->
            <section class="bg-gray-50 py-20">
                <div class="max-w-6xl mx-auto px-8">
                    <div class="text-center mb-16">
                        <h2 class="text-4xl font-bold mb-4">How Onbora Works</h2>
                        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                            Simple setup, intelligent automation, personalized experiences
                        </p>
                    </div>
                    
                    <div class="grid md:grid-cols-3 gap-8">
                        <div class="text-center">
                            <div class="w-16 h-16 bg-black rounded-full flex items-center justify-center mx-auto mb-6">
                                <span class="text-white text-2xl">üìÑ</span>
                            </div>
                            <h3 class="text-xl font-bold mb-4">1. Upload Your Documents</h3>
                            <p class="text-gray-600">
                                Upload your employee handbook, policies, and company documents. 
                                Our AI analyzes them to understand your culture and processes.
                            </p>
                        </div>
                        
                        <div class="text-center">
                            <div class="w-16 h-16 bg-black rounded-full flex items-center justify-center mx-auto mb-6">
                                <span class="text-white text-2xl">ü§ñ</span>
                            </div>
                            <h3 class="text-xl font-bold mb-4">2. AI Learns Your Culture</h3>
                            <p class="text-gray-600">
                                Smart interview captures your unique culture, values, and traditions. 
                                AI agents are trained on your specific company context.
                            </p>
                        </div>
                        
                        <div class="text-center">
                            <div class="w-16 h-16 bg-black rounded-full flex items-center justify-center mx-auto mb-6">
                                <span class="text-white text-2xl">‚ú®</span>
                            </div>
                            <h3 class="text-xl font-bold mb-4">3. Personalized Experience</h3>
                            <p class="text-gray-600">
                                New hires get instant access to AI agents who know your company inside and out. 
                                No more searching through documents or waiting for answers.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Meet Your AI Team Section -->
            <section class="py-20">
                <div class="max-w-6xl mx-auto px-8">
                    <div class="text-center mb-16">
                        <h2 class="text-4xl font-bold mb-4">Meet Your AI Onboarding Team</h2>
                        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                            Four specialized AI agents, each trained on your company's unique culture and processes
                        </p>
                    </div>
                    
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 text-center">
                            <div class="text-4xl mb-4">üëã</div>
                            <h3 class="text-xl font-bold mb-2">Maya</h3>
                            <p class="text-sm text-gray-600 mb-3">Welcome Guide</p>
                            <p class="text-gray-700 text-sm">
                                Helps new hires feel welcomed and oriented. Knows your office layout, 
                                first-day procedures, and company traditions.
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 text-center">
                            <div class="text-4xl mb-4">üìã</div>
                            <h3 class="text-xl font-bold mb-2">Alex</h3>
                            <p class="text-sm text-gray-600 mb-3">HR Assistant</p>
                            <p class="text-gray-700 text-sm">
                                Expert on your benefits, policies, and procedures. Answers questions about 
                                PTO, healthcare, 401k, and company policies instantly.
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 text-center">
                            <div class="text-4xl mb-4">üéØ</div>
                            <h3 class="text-xl font-bold mb-2">Jordan</h3>
                            <p class="text-sm text-gray-600 mb-3">Culture Guide</p>
                            <p class="text-gray-700 text-sm">
                                Shares your company's values, culture, and unwritten rules. 
                                Helps new hires understand "how we do things here."
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 text-center">
                            <div class="text-4xl mb-4">üíª</div>
                            <h3 class="text-xl font-bold mb-2">Sam</h3>
                            <p class="text-sm text-gray-600 mb-3">Tech Setup</p>
                            <p class="text-gray-700 text-sm">
                                Guides through technical setup, tools, and systems. Knows your 
                                specific tech stack and setup procedures.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Features Section -->
            <section class="bg-gray-50 py-20">
                <div class="max-w-6xl mx-auto px-8">
                    <div class="text-center mb-16">
                        <h2 class="text-4xl font-bold mb-4">Powerful Features</h2>
                        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                            Everything you need to create amazing onboarding experiences
                        </p>
                    </div>
                    
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="bg-white rounded-2xl p-6 shadow-sm">
                            <div class="text-3xl mb-4">üß†</div>
                            <h3 class="text-xl font-bold mb-3">Smart Document Analysis</h3>
                            <p class="text-gray-600">
                                AI reads and understands your existing documents, extracting key insights 
                                about your culture, policies, and procedures automatically.
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 shadow-sm">
                            <div class="text-3xl mb-4">üí¨</div>
                            <h3 class="text-xl font-bold mb-3">Intelligent Conversations</h3>
                            <p class="text-gray-600">
                                AI agents provide natural, context-aware responses based on your 
                                specific company information and culture.
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 shadow-sm">
                            <div class="text-3xl mb-4">‚ö°</div>
                            <h3 class="text-xl font-bold mb-3">Instant Setup</h3>
                            <p class="text-gray-600">
                                Get up and running in minutes, not weeks. Upload documents, 
                                quick culture interview, and you're ready to onboard.
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 shadow-sm">
                            <div class="text-3xl mb-4">üìä</div>
                            <h3 class="text-xl font-bold mb-3">Progress Tracking</h3>
                            <p class="text-gray-600">
                                Built-in checklists and progress tracking ensure new hires 
                                complete all necessary onboarding steps.
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 shadow-sm">
                            <div class="text-3xl mb-4">üîÑ</div>
                            <h3 class="text-xl font-bold mb-3">Always Up-to-Date</h3>
                            <p class="text-gray-600">
                                Update your documents and policies anytime. AI agents automatically 
                                learn and adapt to your latest information.
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 shadow-sm">
                            <div class="text-3xl mb-4">üé®</div>
                            <h3 class="text-xl font-bold mb-3">Branded Experience</h3>
                            <p class="text-gray-600">
                                Customize the look and feel to match your brand. Create a cohesive 
                                experience that feels authentically yours.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CTA Section -->
            <section class="py-20">
                <div class="max-w-4xl mx-auto px-8 text-center">
                    <h2 class="text-4xl font-bold mb-4">Ready to Transform Your Onboarding?</h2>
                    <p class="text-xl text-gray-600 mb-8">
                        Join companies who've made onboarding effortless with AI
                    </p>
                    <div class="flex justify-center space-x-4">
                        <button 
                            onclick="showView('setup')"
                            class="bg-black text-white px-8 py-4 rounded-full text-lg hover:bg-gray-800 transition"
                        >
                            Start Free Trial
                        </button>
                        <button 
                            onclick="showView('employee')"
                            class="border-2 border-black text-black px-8 py-4 rounded-full text-lg hover:bg-gray-50 transition"
                        >
                            See Demo
                        </button>
                    </div>
                </div>
            </section>
        </div>

        <!-- Setup Page -->
        <div id="setup" class="hidden min-h-screen bg-gray-50">
            <nav class="bg-white border-b border-gray-200 px-8 py-4">
                <div class="flex justify-between items-center">
                    <div 
                        class="flex items-center space-x-2 cursor-pointer"
                        onclick="showView('landing')"
                    >
                        <div class="w-8 h-8 bg-black rounded-lg flex items-center justify-center">
                            <span class="text-white font-bold text-sm">O</span>
                        </div>
                        <span class="text-xl font-bold">Onbora</span>
                    </div>
                    <button 
                        onclick="showView('landing')"
                        class="text-gray-600 hover:text-black transition text-2xl"
                    >
                        √ó
                    </button>
                </div>
            </nav>

            <div class="max-w-4xl mx-auto px-8 py-12">
                <div class="text-center mb-12">
                    <h1 class="text-4xl font-bold mb-4">Let's get your company set up</h1>
                    <p class="text-xl text-gray-600">
                        This will take about 5 minutes. We'll capture your company info and culture.
                    </p>
                </div>

                <!-- Step 1: Company Info -->
                <div id="step1" class="bg-white rounded-3xl p-8 shadow-sm mb-6">
                    <h2 class="text-2xl font-bold mb-6">Company Information</h2>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Company Name</label>
                            <input type="text" id="companyName" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:border-black" placeholder="Your Company">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Company Size</label>
                            <select id="companySize" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:border-black">
                                <option value="">Select size</option>
                                <option value="1-10">1-10 employees</option>
                                <option value="11-50">11-50 employees</option>
                                <option value="51-200">51-200 employees</option>
                                <option value="201-1000">201-1000 employees</option>
                                <option value="1000+">1000+ employees</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Industry</label>
                            <input type="text" id="companyIndustry" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:border-black" placeholder="e.g., Technology, Healthcare">
                        </div>
                    </div>
                    <div class="mt-6 text-right">
                        <button 
                            onclick="nextStep(2)"
                            class="bg-black text-white px-6 py-3 rounded-xl hover:bg-gray-800 transition"
                        >
                            Continue
                        </button>
                    </div>
                </div>

                <!-- Step 2: Documents -->
                <div id="step2" class="hidden bg-white rounded-3xl p-8 shadow-sm mb-6">
                    <h2 class="text-2xl font-bold mb-6">Company Documents</h2>
                    <p class="text-gray-600 mb-6">
                        Upload your employee handbook, policies, or any other documents that new hires should know about. (e.g., .txt, .md, .pdf)
                    </p>
                    
                    <div id="dropZone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center cursor-pointer transition hover:bg-gray-50" 
                         onclick="document.getElementById('fileInput').click();"
                         ondragover="event.preventDefault(); this.classList.add('border-blue-400', 'bg-blue-50');"
                         ondragleave="this.classList.remove('border-blue-400', 'bg-blue-50');"
                         ondrop="event.preventDefault(); this.classList.remove('border-blue-400', 'bg-blue-50'); handleFileUpload(event.dataTransfer.files);">
                        <div class="text-4xl mb-4">üìÑ</div>
                        <p class="text-gray-600 mb-2">Drag & drop files here, or click to browse</p>
                        <p class="text-sm text-gray-500">AI will analyze text-based files to fuel the interview.</p>
                        <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.txt,.md" class="hidden" onchange="handleFileUpload(this.files);">
                    </div>

                    <div id="fileList" class="mt-4 space-y-2"></div>
                    
                    <div class="mt-6 flex justify-between">
                        <button 
                            onclick="prevStep(1)"
                            class="px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition"
                        >
                            Back
                        </button>
                        <button 
                            onclick="nextStep(3)"
                            class="bg-black text-white px-6 py-3 rounded-xl hover:bg-gray-800 transition"
                        >
                            Continue
                        </button>
                    </div>
                </div>

                <!-- Step 3: Culture Interview -->
                <div id="step3" class="hidden bg-white rounded-3xl p-8 shadow-sm mb-6">
                    <h2 class="text-2xl font-bold mb-6">Let's capture your culture</h2>
                    <p class="text-gray-600 mb-8">
                        I'll analyze your documents first, then have a quick conversation to fill in any gaps. 
                        This usually takes about 2-3 minutes.
                    </p>
                    
                    <!-- Document Analysis Step -->
                    <div id="documentAnalysis" class="bg-blue-50 border border-blue-200 rounded-2xl p-6 mb-6">
                        <div class="text-center">
                            <div class="text-3xl mb-4">üîç</div>
                            <h3 class="text-lg font-semibold text-blue-800 mb-2">Analyzing Your Documents</h3>
                            <p class="text-blue-700 mb-4">AI is reading through your company documents to understand your culture</p>
                            <div class="flex items-center justify-center space-x-2">
                                <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce"></div>
                                <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="interview" class="bg-gray-50 rounded-2xl p-6 hidden">
                        <div id="interviewMessages" class="mb-4 space-y-4 max-h-96 overflow-y-auto">
                            <!-- Interview messages will appear here -->
                        </div>
                        
                        <div class="border-t border-gray-200 pt-4">
                            <div class="flex space-x-3">
                                <input
                                    type="text"
                                    id="interviewInput"
                                    class="flex-1 px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:border-black"
                                    placeholder="Type your answer here..."
                                    onkeypress="if(event.key==='Enter') submitInterview()"
                                >
                                <button 
                                    onclick="submitInterview()"
                                    class="bg-black text-white px-5 py-2.5 rounded-xl hover:bg-gray-800 transition"
                                >
                                    Send
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Interview Summary (shown after completion) -->
                    <div id="interviewSummary" class="hidden mt-6 bg-green-50 border border-green-200 rounded-2xl p-6">
                        <div class="text-center mb-6">
                            <div class="text-4xl mb-4">üéâ</div>
                            <h3 class="text-2xl font-bold mb-2">Interview Complete!</h3>
                            <p class="text-gray-600">Great! I've captured your company culture. Here's a summary:</p>
                        </div>
                        
                        <div id="summaryContent" class="space-y-4 mb-6">
                            <!-- Summary will be populated here -->
                        </div>
                        
                        <div class="text-center">
                            <button 
                                onclick="showView('employee')"
                                class="bg-black text-white px-6 py-3 rounded-xl hover:bg-gray-800 transition"
                            >
                                Preview Your Agents
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Employee Experience Page (Full UI with all agents) -->
        <div id="employee" class="hidden min-h-screen bg-gray-50">
            <nav class="bg-white border-b border-gray-200 px-8 py-4">
                <div class="flex justify-between items-center">
                    <div 
                        class="flex items-center space-x-2 cursor-pointer"
                        onclick="showView('landing')"
                    >
                        <div class="w-8 h-8 bg-black rounded-lg flex items-center justify-center">
                            <span class="text-white font-bold text-sm">O</span>
                        </div>
                        <span class="text-xl font-bold">Onbora</span>
                    </div>
                    <button 
                        onclick="showView('landing')"
                        class="text-gray-600 hover:text-black transition text-2xl"
                    >
                        √ó
                    </button>
                </div>
            </nav>

            <div class="flex h-screen pt-16">
                <!-- Left Sidebar - Agent Selection -->
                <div class="w-80 bg-white border-r border-gray-200 p-6 overflow-y-auto">
                    <h2 class="text-xl font-bold mb-6">Your AI Team</h2>
                    
                    <!-- AI Status Indicator -->
                    <div class="mb-6 p-4 bg-green-50 border border-green-200 rounded-xl">
                        <div class="flex items-center space-x-2 mb-2">
                            <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                            <span class="text-sm font-medium text-green-800">AI Service Active</span>
                        </div>
                        <p class="text-xs text-green-700">
                            Powered by Google Gemini ‚Ä¢ Company context loaded ‚Ä¢ Documents analyzed
                        </p>
                    </div>
                    
                    <div class="space-y-3">
                        <div 
                            onclick="selectAgent('maya')"
                            class="agent-item p-4 rounded-xl cursor-pointer hover:bg-gray-50 transition"
                            data-agent="maya"
                        >
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl">üëã</div>
                                <div class="flex-1">
                                    <h3 class="font-semibold">Maya</h3>
                                    <p class="text-sm text-gray-600">Welcome Guide</p>
                                    <p class="text-xs text-blue-600">AI-powered responses</p>
                                </div>
                            </div>
                        </div>
                        <div 
                            onclick="selectAgent('alex')"
                            class="agent-item p-4 rounded-xl cursor-pointer hover:bg-gray-50 transition"
                            data-agent="alex"
                        >
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl">üìã</div>
                                <div class="flex-1">
                                    <h3 class="font-semibold">Alex</h3>
                                    <p class="text-sm text-gray-600">HR Assistant</p>
                                    <p class="text-xs text-blue-600">AI-powered responses</p>
                                </div>
                            </div>
                        </div>
                        <div 
                            onclick="selectAgent('jordan')"
                            class="agent-item p-4 rounded-xl cursor-pointer hover:bg-gray-50 transition"
                            data-agent="jordan"
                        >
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl">üéØ</div>
                                <div class="flex-1">
                                    <h3 class="font-semibold">Jordan</h3>
                                    <p class="text-sm text-gray-600">Culture Guide</p>
                                    <p class="text-xs text-blue-600">AI-powered responses</p>
                                </div>
                            </div>
                        </div>
                        <div 
                            onclick="selectAgent('sam')"
                            class="agent-item p-4 rounded-xl cursor-pointer hover:bg-gray-50 transition"
                            data-agent="sam"
                        >
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl">üíª</div>
                                <div class="flex-1">
                                    <h3 class="font-semibold">Sam</h3>
                                    <p class="text-sm text-gray-600">Tech Setup</p>
                                    <p class="text-xs text-blue-600">AI-powered responses</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Checklist Section -->
                    <div class="mt-8">
                        <h3 class="text-lg font-semibold mb-4">Onboarding Checklist</h3>
                        <div class="space-y-2">
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="check1" class="w-4 h-4 rounded border-gray-300 text-black focus:ring-black">
                                <label for="check1" class="text-sm text-gray-700">Complete office tour</label>
                            </div>
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="check2" class="w-4 h-4 rounded border-gray-300 text-black focus:ring-black">
                                <label for="check2" class="text-sm text-gray-700">Set up workspace</label>
                            </div>
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="check3" class="w-4 h-4 rounded border-gray-300 text-black focus:ring-black">
                                <label for="check3" class="text-sm text-gray-700">Meet team members</label>
                            </div>
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="check4" class="w-4 h-4 rounded border-gray-300 text-black focus:ring-black">
                                <label for="check4" class="text-sm text-gray-700">Review handbook</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Chat Area -->
                <div class="flex-1 flex flex-col">
                    <!-- Chat Header -->
                    <div class="bg-white border-b border-gray-200 p-6">
                        <div class="flex items-center space-x-4">
                            <div id="currentAgentAvatar" class="text-3xl">üëã</div>
                            <div>
                                <h2 id="currentAgentName" class="text-2xl font-bold">Maya</h2>
                                <p id="currentAgentRole" class="text-gray-600">Welcome Guide</p>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Messages -->
                    <div class="flex-1 bg-gray-50 p-6 overflow-y-auto">
                        <div id="chatMessages" class="space-y-4">
                            <div class="flex justify-start">
                                <div class="max-w-lg">
                                    <div class="flex items-center space-x-2 mb-2">
                                        <span class="text-sm font-medium">Maya</span>
                                        <span class="text-xs px-2 py-0.5 rounded-full bg-purple-100 text-purple-800">Welcome Guide</span>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-2xl px-4 py-3 mr-12">
                                        <p class="text-gray-800">
                                            Hi! I'm Maya, your welcome guide. I'm here to help you get settled in on your first day! 
                                            What would you like to know about getting started?
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Input -->
                    <div class="bg-white border-t border-gray-200 p-6">
                        <div class="flex space-x-3">
                            <input
                                type="text"
                                id="chatInput"
                                class="flex-1 px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:border-black"
                                placeholder="Ask anything..."
                                onkeypress="if(event.key==='Enter') sendMessage()"
                            >
                            <button 
                                onclick="sendMessage()"
                                class="bg-black text-white px-6 py-3 rounded-xl hover:bg-gray-800 transition"
                            >
                                Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentStep = 1;
        let uploadedFileContents = [];
        let currentAgent = 'maya';
        let interviewQuestionIndex = 0;

        const interviewQuestions = [
            "That's great! Now, what are the core values that drive your team? What principles guide how you work together?",
            "Perfect! What should new employees know about your work style? Are you more collaborative or independent? Fast-paced or methodical?",
            "Excellent insights! What are the most important things a new hire should accomplish in their first day?",
            "Very helpful! How about the first week - what key milestones should they hit?",
            "Almost done! What unique traditions, perks, or aspects of your company would make new hires excited to join?",
            "Last question - what's the one piece of advice you'd give to someone starting at your company tomorrow?",
            "Thank you so much! I've captured everything I need to create a personalized onboarding experience for your new hires."
        ];

        const agents = {
            maya: { 
                name: 'Maya', 
                role: 'Welcome Guide', 
                avatar: 'üëã',
                greeting: "Hi! I'm Maya, your welcome guide. I'm here to help you get settled in on your first day! What would you like to know about getting started?"
            },
            alex: { 
                name: 'Alex', 
                role: 'HR Assistant', 
                avatar: 'üìã',
                greeting: "Hello! I'm Alex from HR. I can help you with benefits, policies, and all the administrative stuff. What do you need help with?"
            },
            jordan: { 
                name: 'Jordan', 
                role: 'Culture Guide', 
                avatar: 'üéØ',
                greeting: "Hey there! I'm Jordan, your culture guide. Let me tell you about how we do things here! What would you like to know about our culture?"
            },
            sam: { 
                name: 'Sam', 
                role: 'Tech Setup', 
                avatar: 'üíª',
                greeting: "Hi! I'm Sam from IT. I'll help you get all your tools and accounts set up. What tech setup do you need help with?"
            }
        };

        function showView(viewName) {
            // Hide all views
            document.querySelectorAll('#landing, #setup, #employee').forEach(el => {
                if (el) el.classList.add('hidden');
            });
            
            // Show the requested view
            const view = document.getElementById(viewName);
            if (view) {
                view.classList.remove('hidden');
            }

            // Reset interview if going back to setup
            if (viewName === 'setup') {
                resetInterview();
            }
        }

        function nextStep(step) {
            if (step === 2) {
                const companyName = document.getElementById('companyName').value;
                if (!companyName.trim()) {
                    alert('Please enter your company name');
                    return;
                }
            }
            
            if (step === 3) {
                startDocumentAnalysis();
            }
            
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.getElementById(`step${step}`).classList.remove('hidden');
            currentStep = step;
        }

        async function startDocumentAnalysis() {
            const documentAnalysis = document.getElementById('documentAnalysis');
            const interview = document.getElementById('interview');
            
            // Show analysis in progress
            documentAnalysis.classList.remove('hidden');
            interview.classList.add('hidden');
            
            try {
                // Analyze uploaded documents if any
                let documentInsights = {};
                if (uploadedFileContents.length > 0) {
                    documentInsights = await analyzeDocuments();
                } else {
                    documentInsights = {
                        values: "Needs: company culture description",
                        policies: "Needs: work policies and procedures",
                        structure: "Needs: company structure details",
                        industry: "Needs: industry and business focus",
                        benefits: "Needs: employee benefits information",
                        traditions: "Needs: company traditions and unique aspects"
                    };
                }
                
                // Store insights for the interview
                window.documentInsights = documentInsights;
                
                // Show analysis complete
                setTimeout(() => {
                    documentAnalysis.innerHTML = `
                        <div class="text-center">
                            <div class="text-3xl mb-4">‚úÖ</div>
                            <h3 class="text-lg font-semibold text-green-800 mb-2">Documents Analyzed!</h3>
                            <p class="text-green-700 mb-4">AI found ${Object.keys(documentInsights).length} key insights about your company</p>
                            <button onclick="startSmartInterview()" class="bg-green-600 text-white px-6 py-2 rounded-xl hover:bg-green-700 transition">
                                Start Smart Interview
                            </button>
                        </div>
                    `;
                }, 2000);
                
            } catch (error) {
                // Fallback to manual interview
                startSmartInterview();
            }
        }

        async function analyzeDocuments() {
            try {
                // Create comprehensive document analysis with AI
                const companyName = document.getElementById('companyName').value || 'this company';
                const companySize = document.getElementById('companySize').value || 'unknown size';
                const companyIndustry = document.getElementById('companyIndustry').value || 'unspecified industry';
                
                const systemPrompt = `You are an expert HR analyst specializing in extracting key onboarding information from company documents. You analyze documents to understand what new employees need to know.

Company Context:
- Name: ${companyName}
- Size: ${companySize}
- Industry: ${companyIndustry}

Your task is to analyze the provided documents and extract actionable insights that will help create personalized AI agents for new employee onboarding.

Focus on finding:
1. **Company Values & Culture** - Core values, work style, company personality
2. **Policies & Procedures** - Important rules, processes, work arrangements
3. **Benefits & Perks** - What employees get, unique offerings
4. **Organizational Structure** - Teams, departments, reporting structure
5. **Traditions & Events** - Company traditions, regular events, social aspects
6. **First Day/Week Priorities** - What new hires should focus on initially

Return ONLY a valid JSON object with this exact structure:
{
    "values": "string describing found values or 'Needs clarification'",
    "policies": "string describing found policies or 'Needs clarification'", 
    "benefits": "string describing found benefits or 'Needs clarification'",
    "structure": "string describing found structure or 'Needs clarification'",
    "traditions": "string describing found traditions or 'Needs clarification'",
    "onboarding_priorities": "string describing first day/week priorities or 'Needs clarification'",
    "key_insights": "string with 2-3 most important things new hires should know",
    "gaps": "string listing what key information is missing"
}`;

                const documentContent = uploadedFileContents.map(d => {
                    return `Document: ${d.name}\nContent: ${d.content || '[Binary file - content not analyzable]'}`;
                }).join('\n\n---\n\n');

                const prompt = `${documentContent}\n\nPlease analyze these documents and return the JSON structure requested.`;

                const response = await fetch('/api/gemini', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        systemPrompt: systemPrompt
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                // Try to parse JSON response, fallback to structured object if parsing fails
                try {
                    const parsedResponse = JSON.parse(data.response);
                    // Validate that we have the expected structure
                    if (parsedResponse && typeof parsedResponse === 'object') {
                        return {
                            values: parsedResponse.values || "Needs clarification",
                            policies: parsedResponse.policies || "Needs clarification",
                            benefits: parsedResponse.benefits || "Needs clarification", 
                            structure: parsedResponse.structure || "Needs clarification",
                            traditions: parsedResponse.traditions || "Needs clarification",
                            onboarding_priorities: parsedResponse.onboarding_priorities || "Needs clarification",
                            key_insights: parsedResponse.key_insights || "Company culture analysis needed",
                            gaps: parsedResponse.gaps || "Additional information needed"
                        };
                    }
                } catch (parseError) {
                    // If JSON parsing fails, try to extract insights from raw text
                    const rawText = data.response;
                    return {
                        values: extractFromText(rawText, ['values', 'culture', 'principles']) || "Needs clarification",
                        policies: extractFromText(rawText, ['policy', 'policies', 'procedures', 'rules']) || "Needs clarification",
                        benefits: extractFromText(rawText, ['benefits', 'perks', 'compensation']) || "Needs clarification",
                        structure: extractFromText(rawText, ['structure', 'organization', 'teams', 'departments']) || "Needs clarification", 
                        traditions: extractFromText(rawText, ['traditions', 'events', 'culture', 'social']) || "Needs clarification",
                        onboarding_priorities: extractFromText(rawText, ['onboarding', 'first day', 'new hire', 'priorities']) || "Needs clarification",
                        key_insights: rawText.substring(0, 200) + "...",
                        gaps: "Document analysis completed but structure unclear"
                    };
                }
                
            } catch (error) {
                // Return default structure if AI analysis fails
                return {
                    values: "Needs clarification",
                    policies: "Needs clarification", 
                    benefits: "Needs clarification",
                    structure: "Needs clarification",
                    traditions: "Needs clarification",
                    onboarding_priorities: "Needs clarification",
                    key_insights: "Unable to analyze documents - please provide information during interview",
                    gaps: "Document analysis failed - manual interview required"
                };
            }
        }

        // Helper function to extract information from unstructured text
        function extractFromText(text, keywords) {
            const sentences = text.split(/[.!?]+/);
            for (const sentence of sentences) {
                for (const keyword of keywords) {
                    if (sentence.toLowerCase().includes(keyword.toLowerCase())) {
                        return sentence.trim();
                    }
                }
            }
            return null;
        }

        function startSmartInterview() {
            const documentAnalysis = document.getElementById('documentAnalysis');
            const interview = document.getElementById('interview');
            
            // Hide analysis, show interview
            documentAnalysis.classList.add('hidden');
            interview.classList.remove('hidden');
            
            // Initialize interview with smart first question
            initializeSmartInterview();
        }

        async function initializeSmartInterview() {
            const documentInsights = window.documentInsights || {};
            const interviewMessages = document.getElementById('interviewMessages');
            
            // Clear any existing messages
            interviewMessages.innerHTML = '';
            
            // Create an intelligent first question based on document analysis
            const companyName = document.getElementById('companyName').value || 'your company';
            const companyContext = {
                name: companyName,
                size: document.getElementById('companySize').value,
                industry: document.getElementById('companyIndustry').value,
                insights: documentInsights
            };
            
            try {
                const systemPrompt = `You are an expert onboarding consultant conducting a smart interview to capture company culture. You've already analyzed the company's documents.

Company: ${companyContext.name}
Size: ${companyContext.size}
Industry: ${companyContext.industry}

Document Analysis Results:
${Object.entries(documentInsights).map(([key, value]) => `- ${key}: ${value}`).join('\n')}

Your task: Ask ONE intelligent first question that:
1. Acknowledges what you found in documents
2. Focuses on the biggest gap or most important missing information
3. Is conversational and engaging
4. Will help create better AI agents for new hires

Keep the question under 50 words and be warm and professional.`;

                const prompt = "Generate the perfect first interview question based on the analysis above.";
                
                const response = await fetch('/api/gemini', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        systemPrompt: systemPrompt
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    const intelligentQuestion = data.response || getDefaultFirstQuestion(documentInsights);
                    addInterviewMessage(intelligentQuestion, false);
                } else {
                    addInterviewMessage(getDefaultFirstQuestion(documentInsights), false);
                }
                
            } catch (error) {
                // Fallback to analysis-based question
                addInterviewMessage(getDefaultFirstQuestion(documentInsights), false);
            }
            
            // Reset interview state
            interviewQuestionIndex = 0;
            window.interviewAnswers = [];
        }

        function getDefaultFirstQuestion(insights) {
            // Analyze what we found and what we need
            const hasValues = insights.values && !insights.values.includes('Needs clarification');
            const hasPolicies = insights.policies && !insights.policies.includes('Needs clarification');
            const hasTraditions = insights.traditions && !insights.traditions.includes('Needs clarification');
            
            if (!hasValues) {
                return "I've reviewed your documents and found some great information! To help new hires really understand your culture, what are the core values that drive how your team works together?";
            } else if (!hasTraditions) {
                return "Your company values came through clearly in the documents. What unique traditions or aspects of your culture would make new employees excited to be part of the team?";
            } else if (!hasPolicies) {
                return "I can see your company culture, but what are the most important work policies or procedures that new hires should know about?";
            } else {
                return "Great documentation! To round out the picture, what's the one piece of advice you'd give someone starting at your company tomorrow?";
            }
        }

        function getPriorityTopics(insights) {
            const topics = [];
            if (!insights.values || insights.values.includes('Needs clarification')) {
                topics.push('company values and culture');
            }
            if (!insights.traditions || insights.traditions.includes('Needs clarification')) {
                topics.push('company traditions and unique aspects');
            }
            if (!insights.onboarding_priorities || insights.onboarding_priorities.includes('Needs clarification')) {
                topics.push('first-day priorities and expectations');
            }
            if (!insights.policies || insights.policies.includes('Needs clarification')) {
                topics.push('important work policies');
            }
            return topics.length > 0 ? topics.join(', ') : 'company culture and new hire experience';
        }

        function prevStep(step) {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.getElementById(`step${step}`).classList.remove('hidden');
            currentStep = step;
        }

        function handleFileUpload(files) {
            const fileList = document.getElementById('fileList');
            
            if (!fileList) {
                return;
            }
            
            // It's safer to overwrite than to try and sync
            uploadedFileContents = []; 
            fileList.innerHTML = '';

            if (!files || files.length === 0) {
                return;
            }

            for (const file of files) {
                
                const fileItem = document.createElement('div');
                fileItem.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
                fileItem.innerHTML = `
                    <div class="flex items-center space-x-2 overflow-hidden">
                        <span class="text-xl">üìÑ</span>
                        <span class="text-sm text-gray-700 truncate">${file.name}</span>
                    </div>
                    <span class="file-status text-xs text-blue-600 ml-2">Processing...</span>
                `;
                fileList.appendChild(fileItem);

                const isReadableText = file.type.startsWith('text/') || /\.(txt|md)$/i.test(file.name);
                if (isReadableText) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const content = String(e.target.result || '').slice(0, 8000);
                        uploadedFileContents.push({ name: file.name, type: file.type, content: content });
                        fileItem.querySelector('.file-status').textContent = '‚úì Ready';
                        fileItem.querySelector('.file-status').classList.replace('text-blue-600', 'text-green-600');
                    };
                    reader.onerror = () => {
                        fileItem.querySelector('.file-status').textContent = '‚úó Error';
                        fileItem.querySelector('.file-status').classList.replace('text-blue-600', 'text-red-600');
                    };
                    reader.readAsText(file);
                } else {
                    uploadedFileContents.push({ name: file.name, type: file.type, content: `[File type (${file.type}) not readable in browser]` });
                    fileItem.querySelector('.file-status').textContent = '‚úì Added';
                    fileItem.querySelector('.file-status').classList.replace('text-blue-600', 'text-gray-500');
                }
            }
            
            document.getElementById('fileInput').value = '';
        }

        function submitInterview() {
            const input = document.getElementById('interviewInput');
            const message = input.value.trim();
            if (!message) return;

            // Add user message
            addInterviewMessage(message, true);
            input.value = '';

            // Store the answer for the summary
            if (!window.interviewAnswers) window.interviewAnswers = [];
            window.interviewAnswers.push(message);

            // Show typing indicator for AI
            const typingDiv = document.createElement('div');
            typingDiv.className = 'flex justify-start chat-message';
            typingDiv.id = 'interviewTypingIndicator';
            typingDiv.innerHTML = `
                <div class="max-w-lg">
                    <div class="flex items-center space-x-2 mb-2">
                        <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                            <span>ü§ñ</span>
                        </div>
                        <span class="text-sm font-medium">AI Interviewer</span>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-2xl px-4 py-3 mr-12">
                        <p class="text-gray-800">Thinking...</p>
                    </div>
                </div>
            `;
            document.getElementById('interviewMessages').appendChild(typingDiv);
            document.getElementById('interviewMessages').scrollTop = document.getElementById('interviewMessages').scrollTop;

            // Call AI for intelligent follow-up questions
            callAIInterviewer(message);
        }

        async function callAIInterviewer(message) {
            try {
                // Remove typing indicator
                const typingIndicator = document.getElementById('interviewTypingIndicator');
                if (typingIndicator) typingIndicator.remove();

                // Get document insights and previous answers
                const documentInsights = window.documentInsights || {};
                const previousAnswers = window.interviewAnswers || [];
                
                // Prepare context for the AI interviewer
                const interviewContext = {
                    companyName: document.getElementById('companyName').value || 'Your Company',
                    companySize: document.getElementById('companySize').value || 'Not specified',
                    companyIndustry: document.getElementById('companyIndustry').value || 'Not specified',
                    previousAnswers: previousAnswers,
                    documentInsights: documentInsights,
                    currentQuestion: interviewQuestionIndex + 1,
                    totalQuestions: 7
                };

                // Create smart prompt based on what we already know
                let smartPrompt = `You are an expert onboarding consultant conducting an intelligent interview to capture company culture for new employee AI agents.

                COMPANY CONTEXT:
                Name: ${interviewContext.companyName}
                Size: ${interviewContext.companySize}
                Industry: ${interviewContext.companyIndustry}
                
                DOCUMENT ANALYSIS RESULTS:
                ${Object.entries(documentInsights).map(([key, value]) => `${key}: ${value}`).join('\n')}
                
                PREVIOUS CONVERSATION:
                ${previousAnswers.map((answer, i) => `Answer ${i+1}: ${answer}`).join('\n')}
                
                CURRENT STATUS: Question ${interviewContext.currentQuestion} of 3
                User just said: "${message}"
                
                YOUR TASK:
                ${interviewContext.currentQuestion >= 2 ? 
                    'This is the FINAL question. Thank them and mention the interview is complete.' :
                    'Ask your next intelligent follow-up question that:'
                }
                
                ${interviewContext.currentQuestion < 2 ? `
                1. Builds naturally on their response
                2. Focuses on the BIGGEST gap from document analysis
                3. Will help create better AI agents for new hires
                4. Avoids repeating information already captured
                5. Is conversational and engaging
                
                Prioritize asking about: ${getPriorityTopics(documentInsights)}
                ` : ''}
                
                Keep response under 60 words. Be warm and professional.`;

                const response = await fetch('/api/gemini', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: smartPrompt,
                        maxTokens: 150
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                // Check if interview is complete
                if (interviewQuestionIndex >= 2) { // 3 questions total (0-2)
                    // Interview complete - show summary immediately
                    showInterviewSummary();
                } else {
                    // Add AI response and continue
                    addInterviewMessage(data.response, false);
                    interviewQuestionIndex++;
                }
                
            } catch (error) {
                // Remove typing indicator
                const typingIndicator = document.getElementById('interviewTypingIndicator');
                if (typingIndicator) typingIndicator.remove();
                
                // Fallback to static questions
                if (interviewQuestionIndex < interviewQuestions.length) {
                    addInterviewMessage(interviewQuestions[interviewQuestionIndex], false);
                    interviewQuestionIndex++;
                } else {
                    showInterviewSummary();
                }
            }
        }

        function showInterviewSummary() {
            // Hide interview interface
            document.getElementById('interview').classList.add('hidden');
            
            // Show summary
            const summary = document.getElementById('interviewSummary');
            summary.classList.remove('hidden');
            
            // Get document insights
            const documentInsights = window.documentInsights || {};
            const hasDocuments = uploadedFileContents.length > 0;
            
            // Populate summary content
            const summaryContent = document.getElementById('summaryContent');
            summaryContent.innerHTML = `
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-white p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-2">Company Info</h4>
                        <p class="text-sm text-gray-600">Name: ${document.getElementById('companyName').value || 'Not specified'}</p>
                        <p class="text-sm text-gray-600">Size: ${document.getElementById('companySize').value || 'Not specified'}</p>
                        <p class="text-sm text-gray-600">Industry: ${document.getElementById('companyIndustry').value || 'Not specified'}</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-2">Documents</h4>
                        <p class="text-sm text-gray-600">${uploadedFileContents.length} file(s) uploaded</p>
                        ${hasDocuments ? '<p class="text-xs text-green-600 mt-1">‚úì Documents analyzed by AI</p>' : ''}
                    </div>
                </div>
                
                ${hasDocuments ? `
                <div class="bg-white p-4 rounded-lg">
                    <h4 class="font-semibold text-gray-800 mb-2">üìÑ From Your Documents</h4>
                    <div class="grid md:grid-cols-2 gap-3 text-sm">
                        ${Object.entries(documentInsights).map(([key, value]) => {
                            if (value.includes('Found:')) {
                                return `<div class="text-green-700">‚úì ${key.charAt(0).toUpperCase() + key.slice(1)}: ${value.split('Found:')[1].split('|')[0].trim()}</div>`;
                            } else {
                                return `<div class="text-gray-600">? ${key.charAt(0).toUpperCase() + key.slice(1)}: ${value}</div>`;
                            }
                        }).join('')}
                    </div>
                </div>
                ` : ''}
                
                <div class="bg-white p-4 rounded-lg">
                    <h4 class="font-semibold text-gray-800 mb-2">üéØ Interview Insights</h4>
                    <p class="text-sm text-gray-600">‚úì Company culture & values</p>
                    <p class="text-sm text-gray-600">‚úì Work style & priorities</p>
                    <p class="text-sm text-gray-600">‚úì Key advice for new hires</p>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h4 class="font-semibold text-blue-800 mb-2">üß† Smart Interview Benefits</h4>
                    <p class="text-sm text-blue-700">
                        ${hasDocuments ? 
                            '‚Ä¢ AI analyzed your documents first to avoid redundant questions<br>' +
                            '‚Ä¢ Interview focused only on gaps and unclear areas<br>' +
                            '‚Ä¢ More efficient and personalized experience' :
                            '‚Ä¢ Traditional interview approach to capture your culture<br>' +
                            '‚Ä¢ All insights captured through conversation'
                        }
                    </p>
                </div>
            `;
        }

        function addInterviewMessage(text, isUser) {
            const messagesContainer = document.getElementById('interviewMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex ${isUser ? 'justify-end' : 'justify-start'} chat-message`;
            
            messageDiv.innerHTML = `
                <div class="max-w-lg">
                    ${!isUser ? `
                        <div class="flex items-center space-x-2 mb-2">
                            <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                <span>ü§ñ</span>
                            </div>
                            <span class="text-sm font-medium">AI Interviewer</span>
                        </div>
                    ` : ''}
                    <div class="rounded-2xl px-4 py-3 ${isUser ? 'bg-black text-white ml-12' : 'bg-white border border-gray-200 mr-12'}">
                        <p class="${isUser ? 'text-white' : 'text-gray-800'}">${text}</p>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function selectAgent(agentId) {
            currentAgent = agentId;
            const agent = agents[agentId];
            
            // Update UI
            document.getElementById('currentAgentAvatar').textContent = agent.avatar;
            document.getElementById('currentAgentName').textContent = agent.name;
            document.getElementById('currentAgentRole').textContent = agent.role;
            
            // Update active agent styling
            document.querySelectorAll('.agent-item').forEach(item => {
                item.classList.remove('bg-blue-50', 'border-blue-200');
            });
            document.querySelector(`[data-agent="${agentId}"]`).classList.add('bg-blue-50', 'border-blue-200');
            
            // Add agent greeting message
            addChatMessage(agent.greeting, false);
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;

            // Add user message
            addChatMessage(message, true);
            input.value = '';

            // Show typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'flex justify-start chat-message';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="max-w-lg">
                    <div class="flex items-center space-x-2 mb-2">
                        <span class="text-sm font-medium">${agents[currentAgent].name}</span>
                        <span class="text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-800">${agents[currentAgent].role}</span>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-2xl px-4 py-3 mr-12">
                        <p class="text-gray-800">Typing...</p>
                    </div>
                </div>
            `;
            document.getElementById('chatMessages').appendChild(typingDiv);
            document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollTop;

            // Call the real AI API
            callAIAgent(message, currentAgent);
        }

        async function callAIAgent(message, agentId) {
            try {
                // Remove typing indicator
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) typingIndicator.remove();

                // Prepare comprehensive context for the AI
                const companyContext = {
                    name: document.getElementById('companyName').value || 'Your Company',
                    size: document.getElementById('companySize').value || 'Not specified',
                    industry: document.getElementById('companyIndustry').value || 'Not specified',
                    culture: window.interviewAnswers || [],
                    documents: uploadedFileContents.map(f => f.name),
                    insights: window.documentInsights || {},
                    fullDocumentContent: uploadedFileContents.length > 0 ? 
                        uploadedFileContents.map(d => `${d.name}: ${d.content || '[Binary file]'}`).join('\n\n') : 
                        'No documents uploaded'
                };

                const response = await fetch('/api/ai-chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        agentType: agentId,
                        companyContext: companyContext,
                        isSmartMode: true
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                // Add AI response
                addChatMessage(data.response, false);
                
            } catch (error) {
                // Remove typing indicator
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) typingIndicator.remove();
                
                // Show fallback response
                const fallbackResponses = {
                    maya: "I'm having trouble connecting to my AI brain right now, but I'd be happy to help you with general onboarding questions! What would you like to know about getting started?",
                    alex: "I'm experiencing a technical issue, but I can still help with basic HR questions. What do you need assistance with?",
                    jordan: "I'm having a moment, but I'd love to tell you about company culture! What would you like to know?",
                    sam: "I'm having some tech difficulties, but I can still help with basic setup questions. What do you need help with?"
                };
                addChatMessage(fallbackResponses[agentId], false);
            }
        }

        function addChatMessage(text, isUser) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex ${isUser ? 'justify-end' : 'justify-start'} chat-message`;
            
            messageDiv.innerHTML = `
                <div class="max-w-lg">
                    ${!isUser ? `
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-sm font-medium">${agents[currentAgent].name}</span>
                            <span class="text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-800">${agents[currentAgent].role}</span>
                        </div>
                    ` : ''}
                    <div class="rounded-2xl px-4 py-3 ${isUser ? 'bg-black text-white ml-12' : 'bg-white border border-gray-200 mr-12'}">
                        <p class="${isUser ? 'text-white' : 'text-gray-800'}">${text}</p>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function resetInterview() {
            interviewQuestionIndex = 0;
            document.getElementById('interview').classList.remove('hidden');
            document.getElementById('interviewSummary').classList.add('hidden');
            document.getElementById('interviewMessages').innerHTML = `
                <div class="flex justify-start">
                    <div class="max-w-lg">
                        <div class="flex items-center space-x-2 mb-2">
                            <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                <span>ü§ñ</span>
                            </div>
                            <span class="text-sm font-medium">AI Interviewer</span>
                        </div>
                        <div class="bg-white border border-gray-200 rounded-2xl px-4 py-3 mr-12">
                            <p class="text-gray-800">
                                Welcome! I'm your AI interviewer. I'll help capture what makes your company special. 
                                Let's start with something simple - how would you describe your company culture in a few words?
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            showView('landing');
            
            // Set initial agent as active  
            const mayaAgent = document.querySelector('[data-agent="maya"]');
            if (mayaAgent) {
                mayaAgent.classList.add('bg-blue-50', 'border-blue-200');
            }
        });
    </script>
</body>
</html>